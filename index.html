
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/docs/4.0/assets/img/favicons/favicon.ico">

    <title>Cover Template for Bootstrap</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.0/examples/cover/">

    <!-- Bootstrap core CSS -->
	<link href="../../dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Custom styles for this template -->
    <link href="cover.css" rel="stylesheet">

<title>HostedPayment Test Page</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript">

		$(function () {

			$("#btnOpenAuthorizeNetIFrame").click(function () {
				$("#add_payment").show();
				$("#send_token").attr({ "action": "https://test.authorize.net/payment/payment", "target": "add_payment" }).submit();
				$(window).scrollTop($('#add_payment').offset().top - 50);
			});

		});


	</script>
	<script type="text/javascript">
		//<![CDATA[
		function callParentFunction(str) {
			if (str && str.length > 0
				&& window.parent
				&& window.parent.parent
				&& window.parent.parent.AuthorizeNetIFrame
				&& window.parent.parent.AuthorizeNetIFrame.onReceiveCommunication) {
				// Errors indicate a mismatch in domain between the page containing the iframe and this page.
				window.parent.parent.AuthorizeNetIFrame.onReceiveCommunication(str);
			}
		}

		function receiveMessage(event) {
			if (event && event.data) {
				callParentFunction(event.data);
			}
		}

		if (window.addEventListener) {
			window.addEventListener("message", receiveMessage, false);
		} else if (window.attachEvent) {
			window.attachEvent("onmessage", receiveMessage);
		}

		if (window.location.hash && window.location.hash.length > 1) {
			callParentFunction(window.location.hash.substring(1));
		}
		//]]/>
	</script>


  </head>

  <body class="text-center" onLoad="getToken()">

    <div class="cover-container d-flex h-100 p-3 mx-auto flex-column">
      <header class="masthead mb-auto">
        <div class="inner">
          <h3 class="masthead-brand">Cover</h3>
          <nav class="nav nav-masthead justify-content-center">
            <a class="nav-link active" href="#">Home</a>
            <a class="nav-link" href="#">Features</a>
            <a class="nav-link" href="#">Contact</a>
          </nav>
        </div>
      </header>

      <main role="main" class="inner cover">
       	<div>
		Open Authorize.Net in an iframe to complete transaction
		<button id="btnOpenAuthorizeNetIFrame" onclick='getToken()'>Show Payment Form</button>
	</div>
	<div id="iframe_holder" class="center-block" style="width:90%;max-width: 1000px">
		<iframe id="add_payment" class="embed-responsive-item panel" name="add_payment" width="100%" frameborder="0" scrolling="no"
		 hidden="true">
		</iframe>
	</div>
	<form id="send_token" action="" method="post" target="add_payment">
		<input type="hidden" id="token" name="token" value="" />
	</form>

	<script type="text/javascript">

		function getToken() {
			var url_base = 'https://apitest.authorize.net/xml/v1/request.api'
			var requestBody =
				{
					"getHostedPaymentPageRequest": {
						"merchantAuthentication": {
							"name": "5KP3u95bQpv",
							"transactionKey": "346HZ32z3fP4hTG2"
						},
						"transactionRequest": {
							"transactionType": "authCaptureTransaction",
							"amount": "250.00",
							"profile": {
								"customerProfileId": "123456789"
							},
							"customer": {
								"email": "ellen@mail.com"
							},
							"billTo": {
								"firstName": "Ellen",
								"lastName": "Johnson",
								"company": "Souveniropolis",
								"address": "14 Main Street",
								"city": "Pecan Springs",
								"state": "TX",
								"zip": "44628",
								"country": "USA"
							}
						},
						"hostedPaymentSettings": {
							"setting": [{
								"settingName": "hostedPaymentReturnOptions",
								"settingValue": "{\"showReceipt\": true, \"url\": \"https://jopatwa.github.io/testpage\", \"urlText\": \"Continue\", \"cancelUrl\": \"https://jopatwa.github.io/testpage\", \"cancelUrlText\": \"Cancel\"}"
							}, {
								"settingName": "hostedPaymentButtonOptions",
								"settingValue": "{\"text\": \"Pay\"}"
							}, {
								"settingName": "hostedPaymentStyleOptions",
								"settingValue": "{\"bgColor\": \"blue\"}"
							}, {
								"settingName": "hostedPaymentPaymentOptions",
								"settingValue": "{\"cardCodeRequired\": false, \"showCreditCard\": true, \"showBankAccount\": true}"
							}, {
								"settingName": "hostedPaymentSecurityOptions",
								"settingValue": "{\"captcha\": false}"
							}, {
								"settingName": "hostedPaymentShippingAddressOptions",
								"settingValue": "{\"show\": false, \"required\": false}"
							}, {
								"settingName": "hostedPaymentBillingAddressOptions",
								"settingValue": "{\"show\": true, \"required\": false}"
							}, {
								"settingName": "hostedPaymentCustomerOptions",
								"settingValue": "{\"showEmail\": false, \"requiredEmail\": false, \"addPaymentProfile\": true}"
							}, {
								"settingName": "hostedPaymentOrderOptions",
								"settingValue": "{\"show\": true, \"merchantName\": \"G and S Questions Inc.\"}"
							}, {
								"settingName": "hostedPaymentIFrameCommunicatorUrl",
								"settingValue": "{\"url\": \"https://jopatwa.github.io/testpage\"}"
							}]
						}
					}
				}
			$.ajax({
				'url': url_base,
				'type': 'POST',
				'content-Type': 'x-www-form-urlencoded',
				'dataType': 'json',
				'data': JSON.stringify(requestBody),
				'success': function (result) {
					$("#token").val(result.token);
					console.log("Token: " + result.token);
					console.log("Token Value in HTML " + $("#token").val())
			
				}
			});
		}

	</script>

	<script type="text/javascript">

		(function () {
			if (!window.AuthorizeNetIFrame) window.AuthorizeNetIFrame = {};
			AuthorizeNetIFrame.onReceiveCommunication = function (querystr) {
				var params = parseQueryString(querystr);
				switch (params["action"]) {
					case "successfulSave":
						break;
					case "cancel":
						break;
					case "resizeWindow":
						var w = parseInt(params["width"]);
						var h = parseInt(params["height"]);
						var ifrm = document.getElementById("add_payment");
						ifrm.style.width = w.toString() + "px";
						ifrm.style.height = h.toString() + "px";
						break;
					case "transactResponse":
						var ifrm = document.getElementById("add_payment");
						ifrm.style.display = 'none';
				}
			};

			function parseQueryString(str) {
				var vars = [];
				var arr = str.split('&');
				var pair;
				for (var i = 0; i < arr.length; i++) {
					pair = arr[i].split('=');
					vars.push(pair[0]);
					vars[pair[0]] = unescape(pair[1]);
				}
				return vars;
			}
		}());
	</script>
      </main>

      <footer class="mastfoot mt-auto">
        <div class="inner">
          <p>Cover template for <a href="https://getbootstrap.com/">Bootstrap</a>, by <a href="https://twitter.com/mdo">@mdo</a>.</p>
        </div>
      </footer>
    </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="../../assets/js/vendor/popper.min.js"></script>
    <script src="../../dist/js/bootstrap.min.js"></script>
  </body>
</html>
