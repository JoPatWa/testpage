<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">

<head>
	<title>HostedPayment Test Page</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript">

		$(function () {

			$("#btnOpenAuthorizeNetIFrame").click(function () {
				$("#add_payment").show();
				$("#send_token").attr({ "action": "https://test.authorize.net/payment/payment", "target": "add_payment" }).submit();
				$(window).scrollTop($('#add_payment').offset().top - 50);
			});

		});


	</script>
	<script type="text/javascript">
		//<![CDATA[
			function callParentFunction(str) {
				if (str && str.length > 0 
					&& window.parent 
					&& window.parent.parent
					&& window.parent.parent.AuthorizeNetIFrame 
					&& window.parent.parent.AuthorizeNetIFrame.onReceiveCommunication)
					{
// Errors indicate a mismatch in domain between the page containing the iframe and this page.
						window.parent.parent.AuthorizeNetIFrame.onReceiveCommunication(str);
					}
				}

			function receiveMessage(event) {
				if (event && event.data) {
					callParentFunction(event.data);
					}
				}

				if (window.addEventListener) {
					window.addEventListener("message", receiveMessage, false);
					} else if (window.attachEvent) {
						window.attachEvent("onmessage", receiveMessage);
					}

				if (window.location.hash && window.location.hash.length > 1) {
					callParentFunction(window.location.hash.substring(1));
					}
		//]]/>
	</script>
</head>

<body>

	<div>
		Open Authorize.Net in an iframe to complete transaction
		<button id="btnOpenAuthorizeNetIFrame" onclick='$.post("https://apitest.authorize.net/xml/v1/request.api",
		{
			"getHostedPaymentPageRequest": {
				"merchantAuthentication": {
					"name": "5KP3u95bQpv",
					"transactionKey": "346HZ32z3fP4hTG2"
				},
				"transactionRequest": {
					"transactionType": "authCaptureTransaction",
					"amount": "20.00",
					"profile": {
						"customerProfileId": "123456789"
					},
					"customer": {
						"email": "ellen@mail.com"
					},
					"billTo": {
						"firstName": "Ellen",
						"lastName": "Johnson",
						"company": "Souveniropolis",
						"address": "14 Main Street",
						"city": "Pecan Springs",
						"state": "TX",
						"zip": "44628",
						"country": "USA"
					}
				},
				"hostedPaymentSettings": {
					"setting": [{
						"settingName": "hostedPaymentReturnOptions",
						"settingValue": "{\"showReceipt\": true, \"url\": \"https://jopatwa.github.io/testpage\", \"urlText\": \"Continue\", \"cancelUrl\": \"https://jopatwa.github.io/testpage\", \"cancelUrlText\": \"Cancel\"}"
					}, {
						"settingName": "hostedPaymentButtonOptions",
						"settingValue": "{\"text\": \"Pay\"}"
					}, {
						"settingName": "hostedPaymentStyleOptions",
						"settingValue": "{\"bgColor\": \"blue\"}"
					}, {
						"settingName": "hostedPaymentPaymentOptions",
						"settingValue": "{\"cardCodeRequired\": false, \"showCreditCard\": true, \"showBankAccount\": true}"
					}, {
						"settingName": "hostedPaymentSecurityOptions",
						"settingValue": "{\"captcha\": false}"
					}, {
						"settingName": "hostedPaymentShippingAddressOptions",
						"settingValue": "{\"show\": false, \"required\": false}"
					}, {
						"settingName": "hostedPaymentBillingAddressOptions",
						"settingValue": "{\"show\": true, \"required\": false}"
					}, {
						"settingName": "hostedPaymentCustomerOptions",
						"settingValue": "{\"showEmail\": false, \"requiredEmail\": false, \"addPaymentProfile\": true}"
					}, {
						"settingName": "hostedPaymentOrderOptions",
						"settingValue": "{\"show\": true, \"merchantName\": \"G and S Questions Inc.\"}"
					}, {
						"settingName": "hostedPaymentIFrameCommunicatorUrl",
						"settingValue": "{\"url\": \"https://jopatwa.github.io/testpage\"}"
					}]
				}
			}
		},
		function(data,status){
		console.log(("Data: " + JSON.stringify(data) + "\nStatus: " + status));
		}
		);'>Show Payment Form</button>
	</div>
	<div id="iframe_holder" class="center-block" style="width:90%;max-width: 1000px">
		<iframe id="add_payment" class="embed-responsive-item panel" name="add_payment" width="100%" frameborder="0" scrolling="no"
		 hidden="true">
		</iframe>
	</div>
	<form id="send_token" action="" method="post" target="add_payment">
		<input type="hidden" name="token" value="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.5KP3u95bQpv"/>
	</form>
<!--
	<script type="text/javascript">
		requestBody = {
			"getHostedPaymentPageRequest": {
				"merchantAuthentication": {
					"name": "5KP3u95bQpv",
					"transactionKey": "346HZ32z3fP4hTG2"
				},
				"transactionRequest": {
					"transactionType": "authCaptureTransaction",
					"amount": "250.00",
					"profile": {
						"customerProfileId": "123456789"
					},
					"customer": {
						"email": "ellen@mail.com"
					},
					"billTo": {
						"firstName": "Ellen",
						"lastName": "Johnson",
						"company": "Souveniropolis",
						"address": "14 Main Street",
						"city": "Pecan Springs",
						"state": "TX",
						"zip": "44628",
						"country": "USA"
					}
				},
				"hostedPaymentSettings": {
					"setting": [{
						"settingName": "hostedPaymentReturnOptions",
						"settingValue": "{\"showReceipt\": true, \"url\": \"https://jopatwa.github.io/testpage\", \"urlText\": \"Continue\", \"cancelUrl\": \"https://jopatwa.github.io/testpage\", \"cancelUrlText\": \"Cancel\"}"
					}, {
						"settingName": "hostedPaymentButtonOptions",
						"settingValue": "{\"text\": \"Pay\"}"
					}, {
						"settingName": "hostedPaymentStyleOptions",
						"settingValue": "{\"bgColor\": \"blue\"}"
					}, {
						"settingName": "hostedPaymentPaymentOptions",
						"settingValue": "{\"cardCodeRequired\": false, \"showCreditCard\": true, \"showBankAccount\": true}"
					}, {
						"settingName": "hostedPaymentSecurityOptions",
						"settingValue": "{\"captcha\": false}"
					}, {
						"settingName": "hostedPaymentShippingAddressOptions",
						"settingValue": "{\"show\": false, \"required\": false}"
					}, {
						"settingName": "hostedPaymentBillingAddressOptions",
						"settingValue": "{\"show\": true, \"required\": false}"
					}, {
						"settingName": "hostedPaymentCustomerOptions",
						"settingValue": "{\"showEmail\": false, \"requiredEmail\": false, \"addPaymentProfile\": true}"
					}, {
						"settingName": "hostedPaymentOrderOptions",
						"settingValue": "{\"show\": true, \"merchantName\": \"G and S Questions Inc.\"}"
					}, {
						"settingName": "hostedPaymentIFrameCommunicatorUrl",
						"settingValue": "{\"url\": \"https://jopatwa.github.io/testpage\"}"
					}]
				}
			}
		}
		$('#btnOpenAuthorizeNetIFrame').click(function () {
			var value = $(this).val();
			$.ajax
				({
					url: 'https://apitest.authorize.net/xml/v1/request.api',
					data: requestBody,
					dataType: 'json',
					contentType: "application/json; charset=utf-8",
					type: 'post',
					success: function (data) {
						console.log('Results' + value + '----' + JSON.stringify(data) + data)
					}
				});
		});
	</script>
-->

	<script type="text/javascript">

		(function () {
			if (!window.AuthorizeNetIFrame) window.AuthorizeNetIFrame = {};
			AuthorizeNetIFrame.onReceiveCommunication = function (querystr) {
				var params = parseQueryString(querystr);
				switch (params["action"]) {
					case "successfulSave":
						break;
					case "cancel":
						break;
					case "resizeWindow":
						var w = parseInt(params["width"]);
						var h = parseInt(params["height"]);
						var ifrm = document.getElementById("add_payment");
						ifrm.style.width = w.toString() + "px";
						ifrm.style.height = h.toString() + "px";
						break;
					case "transactResponse":
						var ifrm = document.getElementById("add_payment");
						ifrm.style.display = 'none';
				}
			};

			function parseQueryString(str) {
				var vars = [];
				var arr = str.split('&');
				var pair;
				for (var i = 0; i < arr.length; i++) {
					pair = arr[i].split('=');
					vars.push(pair[0]);
					vars[pair[0]] = unescape(pair[1]);
				}
				return vars;
			}
		}());
	</script>
</body>

</html>