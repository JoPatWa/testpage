<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">

<head>
	<title>HostedPayment Test Page</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript">

		$(function () {

			$("#btnOpenAuthorizeNetIFrame").click(function () {
				$("#add_payment").show();
				$("#send_token").attr({ "action": "https://test.authorize.net/payment/payment", "target": "add_payment" }).submit();
				$(window).scrollTop($('#add_payment').offset().top - 50);
			});

		});


	</script>
</head>

<body>

	<div>
		Open Authorize.Net in an iframe to complete transaction
		<button id="btnOpenAuthorizeNetIFrame" onclick='$.post("https://apitest.authorize.net/xml/v1/request.api",
		{
		"getHostedPaymentPageRequest": {
		"merchantAuthentication": {
			"name": "5KP3u95bQpv",
			"transactionKey": "346HZ32z3fP4hTG2"
		},
		"transactionRequest": {
		"transactionType": "authCaptureTransaction",
		"amount": "20.00",
		"customer": {
		"email": "bmcmanus@mail.com"
		},
		"billTo": {
		"firstName": "Ellen",
		"lastName": "Johnson",
		"company": "Souveniropolis",
		"address": "14 Main Street",
		"city": "Pecan Springs",
		"state": "TX",
		"zip": "44628",
		"country": "USA"
		}
		},
		"hostedPaymentSettings": {
		"setting": [{
		"settingName": "hostedPaymentBillingAddressOptions",
		"settingValue": "{\"show\": true, \"required\":true}"
		}, {
		"settingName": "hostedPaymentButtonOptions",
		"settingValue": "{\"text\": \"Pay\"}"
		}, {
		"settingName": "hostedPaymentCustomerOptions",
		"settingValue": "{\"showEmail\":true,\"requiredEmail\":true}"
		}, {
		"settingName": "hostedPaymentPaymentOptions",
		"settingValue": "{\"cardCodeRequired\":true}"
		}, {
		"settingName": "hostedPaymentReturnOptions",
		"settingValue": "{\"url\":\"https://www.mysite.com/continue\",\"urlText\":\"Continue\",\"cancelUrl\":\"https://mysite.com/cancel\",\"cancelUrlText\":\"Cancel\"}"
		}, {
		"settingName": "hostedPaymentSecurityOptions",
		"settingValue": "{\"captcha\": false}"
		}, {
		"settingName": "hostedPaymentShippingAddressOptions",
		"settingValue": "{\"show\":false,\"required\":true}"
		}, {
		"settingName": "hostedPaymentStyleOptions",
		"settingValue": "{\"bgColor\": \"EE00EE\"}"
		}]
		}
		}
		},
		function(data,status){
		alert("Data: " + data + "\nStatus: " + status);
		}
		);'>Show Payment Form</button>
	</div>
	<div id="iframe_holder" class="center-block" style="width:90%;max-width: 1000px">
		<iframe id="add_payment" class="embed-responsive-item panel" name="add_payment" width="100%" frameborder="0" scrolling="no"
		 hidden="true">
		</iframe>
	</div>
	<form id="send_token" action="" method="post" target="add_payment">
		<input type="hidden" name="token" value="" />
	</form>
<!--
	<script type="text/javascript">
		requestBody = {
			"getHostedPaymentPageRequest": {
				"merchantAuthentication": {
					"name": "5KP3u95bQpv",
					"transactionKey": "346HZ32z3fP4hTG2"
				},
				"transactionRequest": {
					"transactionType": "authCaptureTransaction",
					"amount": "250.00",
					"profile": {
						"customerProfileId": "123456789"
					},
					"customer": {
						"email": "ellen@mail.com"
					},
					"billTo": {
						"firstName": "Ellen",
						"lastName": "Johnson",
						"company": "Souveniropolis",
						"address": "14 Main Street",
						"city": "Pecan Springs",
						"state": "TX",
						"zip": "44628",
						"country": "USA"
					}
				},
				"hostedPaymentSettings": {
					"setting": [{
						"settingName": "hostedPaymentReturnOptions",
						"settingValue": "{\"showReceipt\": true, \"url\": \"https://jopatwa.github.io/testpage\", \"urlText\": \"Continue\", \"cancelUrl\": \"https://jopatwa.github.io/testpage\", \"cancelUrlText\": \"Cancel\"}"
					}, {
						"settingName": "hostedPaymentButtonOptions",
						"settingValue": "{\"text\": \"Pay\"}"
					}, {
						"settingName": "hostedPaymentStyleOptions",
						"settingValue": "{\"bgColor\": \"blue\"}"
					}, {
						"settingName": "hostedPaymentPaymentOptions",
						"settingValue": "{\"cardCodeRequired\": false, \"showCreditCard\": true, \"showBankAccount\": true}"
					}, {
						"settingName": "hostedPaymentSecurityOptions",
						"settingValue": "{\"captcha\": false}"
					}, {
						"settingName": "hostedPaymentShippingAddressOptions",
						"settingValue": "{\"show\": false, \"required\": false}"
					}, {
						"settingName": "hostedPaymentBillingAddressOptions",
						"settingValue": "{\"show\": true, \"required\": false}"
					}, {
						"settingName": "hostedPaymentCustomerOptions",
						"settingValue": "{\"showEmail\": false, \"requiredEmail\": false, \"addPaymentProfile\": true}"
					}, {
						"settingName": "hostedPaymentOrderOptions",
						"settingValue": "{\"show\": true, \"merchantName\": \"G and S Questions Inc.\"}"
					}, {
						"settingName": "hostedPaymentIFrameCommunicatorUrl",
						"settingValue": "{\"url\": \"https://jopatwa.github.io/testpage\"}"
					}]
				}
			}
		}
		$('#btnOpenAuthorizeNetIFrame').click(function () {
			var value = $(this).val();
			$.ajax
				({
					url: 'https://apitest.authorize.net/xml/v1/request.api',
					data: requestBody,
					dataType: 'json',
					contentType: "application/json; charset=utf-8",
					type: 'post',
					success: function (data) {
						console.log('Results' + value + '----' + JSON.stringify(data) + data)
					}
				});
		});
	</script>
-->

	<script type="text/javascript">

		(function () {
			if (!window.AuthorizeNetIFrame) window.AuthorizeNetIFrame = {};
			AuthorizeNetIFrame.onReceiveCommunication = function (querystr) {
				var params = parseQueryString(querystr);
				switch (params["action"]) {
					case "successfulSave":
						break;
					case "cancel":
						break;
					case "resizeWindow":
						var w = parseInt(params["width"]);
						var h = parseInt(params["height"]);
						var ifrm = document.getElementById("add_payment");
						ifrm.style.width = w.toString() + "px";
						ifrm.style.height = h.toString() + "px";
						break;
					case "transactResponse":
						var ifrm = document.getElementById("add_payment");
						ifrm.style.display = 'none';
				}
			};

			function parseQueryString(str) {
				var vars = [];
				var arr = str.split('&');
				var pair;
				for (var i = 0; i < arr.length; i++) {
					pair = arr[i].split('=');
					vars.push(pair[0]);
					vars[pair[0]] = unescape(pair[1]);
				}
				return vars;
			}
		}());
	</script>
</body>

</html>